{"version":3,"sources":["app/BarcodeReader.js","app/initialize.js","app/parentCompanySearch.js","app/upcSearch.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArCA;AAAA;CCAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAZA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAxDA;AAAA;ACAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3OA;AAAA","file":"public/app.js","sourcesContent":["\"use strict\";\n\nfunction openReader() {\n    Quagga.init({\n        inputStream: {\n            name: \"Live\",\n            type: \"LiveStream\",\n            constraints: {\n                width: 640,\n                height: 480,\n                facingMode: \"environment\"\n            }\n        },\n        locator: {\n            patchSize: \"medium\",\n            halfSample: true\n        },\n        numOfWorkers: 4,\n        locate: true,\n        decoder: {\n            readers: [\"upc_reader\", \"upc_e_reader\"]\n        }\n    }, function () {\n        Quagga.start();\n    });\n\n    Quagga.onDetected(function (result) {\n        var code = result.codeResult.code;\n        //console.log(\"The code is \"+code);\n\n        var $form = $(\"#form-search\");\n\n        $form.find(\"input[name='query']\").val(code);\n        Quagga.stop();\n        $form.submit();\n    });\n}\n","'use strict';\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  // do your setup here\n\n\n  // delete if jquery script in index is necessary\n  var $ = require('jquery');\n  console.log('Tasty Brunch, just trying to use jQuery!', $('body'));\n\n  console.log('Initialized app');\n});\n","\"use strict\";\n\nmodule.exports = {\n    min_cw_idSearch: function min_cw_idSearch(results, min_cw_id, err) {\n\n        var results = results.body;\n        results = JSON.parse(results);\n        //console.log(results);\n        var companiesList = results.result.companies;\n        var cw_id_keys = [];\n        for (var cw_id_key in companiesList) {\n            if (companiesList.hasOwnProperty(cw_id_key)) {\n                cw_id_keys.push(cw_id_key);\n            }\n        }\n\n        var numResults = cw_id_keys.length;\n\n        if (numResults === 0) {\n            return new Error(results.meta.status_string);\n        } else {\n            //return shortest cw_id\n\n            var findShortestCW_id = function findShortestCW_id() {\n                var min = cw_id_keys[0];\n                for (i = 1; i < numResults; i++) {\n                    var a = cw_id_keys[i];\n                    if (a.length < min.length) {\n                        min = a;\n                    }\n                }\n                return min;\n            };\n\n            var min_cw_id = findShortestCW_id(results);\n            //console.log(min_cw_id);\n            return min_cw_id;\n        } //,\n        // function(err) {\n        //     callback(new Error(err.responseText));\n        // }\n    },\n\n    parentCo_Query: function parentCo_Query(results, parentCo, err) {\n        var results = results.body;\n        results = JSON.parse(results);\n        //console.log(results);\n        var companiesList = results.result.companies;\n        for (var cw_id_key in companiesList) {\n            if (companiesList.hasOwnProperty(cw_id_key)) {\n                var parentCo = results.result.companies[cw_id_key].company_name;\n                return parentCo;\n            }\n        }\n    }\n};\n","\"use strict\";\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction numberWithCommas(x) {\n    return x.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n}\n\nwindow.upcSearch = {\n    queryProducts: function queryProducts(query, $brand, $manufacturer, $subsidies, $violations, $co_profile_description) {\n\n        $.get('/products/' + query).then(function (response) {\n\n            var parentCo = response.parentCo;\n            //console.log(\"response: \"+ response);\n            var subsidyData = response.subsidyData;\n            var violationData = response.violationData;\n            var bloomberg = response.bloomberg;\n            var secretsSummary = response.secretsSummary;\n            //console.log(secretsSummary);\n            //console.log(\"bloomberg: \"+JSON.stringify(bloomberg));\n            //console.log(\"violationData: \" +JSON.stringify(violationData));\n            //console.log(\"subsidyData: \" + JSON.stringify(subsidyData));\n\n            //handlebars compile for subsidies\n            var sub_hndlbr_source = $(\"#subsidies-template\").html();\n            var subsidies_template = Handlebars.compile(sub_hndlbr_source);\n\n            var subsidies = [];\n            var subsidy;\n            if (subsidyData.record_count == 1) {\n                subsidy = {\n                    company: subsidyData.data.record.company,\n                    parent_company: subsidyData.data.record.parent_company,\n                    subsidy_source: subsidyData.data.record.subsidy_source,\n                    location: subsidyData.data.record.location,\n                    city: subsidyData.data.record.city,\n                    county: subsidyData.data.record.county,\n                    description: subsidyData.data.record.description,\n                    subsidy_year: subsidyData.data.record.subsidy_year,\n                    subsidy_value: subsidyData.data.record.subsidy_amount_in_dollars,\n                    program_name: subsidyData.data.record.program,\n                    subsidy_type: subsidyData.data.record.subsidy_type,\n                    jobs_data: subsidyData.data.record.jobs_data,\n                    investment_data: subsidyData.data.record.investment_data,\n                    notes: subsidyData.data.record.notes\n                };\n                subsidies.push(subsidy);\n                var context_sub = {\n                    subsidies: subsidies\n                };\n            } else {\n                for (i = 0; i < subsidyData.record_count; i++) {\n\n                    subsidy = {\n                        company: subsidyData.data.record[i].company,\n                        parent_company: subsidyData.data.record[i].parent_company,\n                        subsidy_source: subsidyData.data.record[i].subsidy_source,\n                        location: subsidyData.data.record[i].location,\n                        city: subsidyData.data.record[i].city,\n                        county: subsidyData.data.record[i].county,\n                        description: subsidyData.data.record[i].description,\n                        subsidy_year: subsidyData.data.record[i].subsidy_year,\n                        subsidy_value: subsidyData.data.record[i].subsidy_amount_in_dollars,\n                        program_name: subsidyData.data.record[i].program,\n                        subsidy_type: subsidyData.data.record[i].subsidy_type,\n                        jobs_data: subsidyData.data.record[i].jobs_data,\n                        investment_data: subsidyData.data.record[i].investment_data,\n                        notes: subsidyData.data.record[i].notes\n                    };\n                    subsidies.push(subsidy);\n                }\n                //console.log(subsidies);\n                var context_sub = {\n                    subsidies: subsidies\n                };\n            }\n            $(\"#subsidiesResults\").html(subsidies_template(context_sub));\n            //console.log(context);\n\n\n            //handlebars compile for violations\n            var vio_hndlbr_source = $(\"#violations-template\").html();\n            var violations_template = Handlebars.compile(vio_hndlbr_source);\n\n            var violations = [];\n            var violation;\n            if (violationData.record_count == 1) {\n                violation = {\n                    company: violationData.data.record.company,\n                    parent_company: violationData.data.record.parent_company,\n                    location: violationData.data.record.location_state,\n                    violation_city: violationData.data.record.city,\n                    penalty_amount_in_dollars: numberWithCommas(violationData.data.record.penalty_amount_in_dollars),\n                    primary_offense: violationData.data.record.primary_offense,\n                    description: violationData.data.record.description,\n                    penalty_year: violationData.data.record.penalty_year,\n                    violation_agency: violationData.data.record.agency,\n                    civil_criminal: violationData.data.record.civil_criminal,\n                    hq_country_of_parent: violationData.data.record.hq_country_of_parent,\n                    hq_state_of_parent: violationData.data.record.hq_state_of_parent,\n                    ownership_structure_of_parent: violationData.data.record.ownership_structure_of_parent,\n                    violation_notes: violationData.data.record.notes\n                };\n                violations.push(violation);\n\n                var context_vio = { violations: violations };\n            } else {\n                for (i = 0; i < violationData.record_count; i++) {\n                    violation = {\n                        company: violationData.data.record[i].company,\n                        parent_company: violationData.data.record[i].parent_company,\n                        location: violationData.data.record[i].location_state,\n                        violation_city: violationData.data.record[i].city,\n                        penalty_amount_in_dollars: numberWithCommas(violationData.data.record[i].penalty_amount_in_dollars),\n                        primary_offense: violationData.data.record[i].primary_offense,\n                        description: violationData.data.record[i].description,\n                        penalty_year: violationData.data.record[i].penalty_year,\n                        violation_agency: violationData.data.record[i].agency,\n                        civil_criminal: violationData.data.record[i].civil_criminal,\n                        hq_country_of_parent: violationData.data.record[i].hq_country_of_parent,\n                        hq_state_of_parent: violationData.data.record[i].hq_state_of_parent,\n                        ownership_structure_of_parent: violationData.data.record[i].ownership_structure_of_parent,\n                        violation_notes: violationData.data.record[i].notes\n                    };\n                    //console.log(violation);\n                    violations.push(violation);\n                }\n                //console.log(violations);\n                var context_vio = { violations: violations };\n            }\n\n            $(\"#violationsResults\").html(violations_template(context_vio));\n\n            //handlebars compile for bloomberg execs\n            var execs_source = $(\"#execs-template\").html();\n            var execs_template = Handlebars.compile(execs_source);\n            var context_execs = bloomberg.execs;\n            $(\"#execsResults\").html(execs_template(context_execs));\n\n            $(\"#co_profile_description\").html(bloomberg.co_profile.description);\n            $(\"#co_profile_address\").html(bloomberg.co_profile.address);\n            $(\"#co_profile_phone\").html(bloomberg.co_profile.phone);\n            $(\"#co_profile_website\").html(bloomberg.co_profile.website);\n            $(\"#co_profile_website\").attr(\"href\", bloomberg.co_profile.url);\n\n            Handlebars.registerHelper(\"time_ago\", function time_ago(time) {\n\n                switch (typeof time === \"undefined\" ? \"undefined\" : _typeof(time)) {\n                    case 'number':\n                        break;\n                    case 'string':\n                        time = +new Date(time);\n                        break;\n                    case 'object':\n                        if (time.constructor === Date) time = time.getTime();\n                        break;\n                    default:\n                        time = +new Date();\n                }\n                var time_formats = [[60, 'seconds', 1], // 60\n                [120, '1 minute ago', '1 minute from now'], // 60*2\n                [3600, 'minutes', 60], // 60*60, 60\n                [7200, '1 hour ago', '1 hour from now'], // 60*60*2\n                [86400, 'hours', 3600], // 60*60*24, 60*60\n                [172800, 'Yesterday', 'Tomorrow'], // 60*60*24*2\n                [604800, 'days', 86400], // 60*60*24*7, 60*60*24\n                [1209600, 'Last week', 'Next week'], // 60*60*24*7*4*2\n                [2419200, 'weeks', 604800], // 60*60*24*7*4, 60*60*24*7\n                [4838400, 'Last month', 'Next month'], // 60*60*24*7*4*2\n                [29030400, 'months', 2419200], // 60*60*24*7*4*12, 60*60*24*7*4\n                [58060800, 'Last year', 'Next year'], // 60*60*24*7*4*12*2\n                [2903040000, 'years', 29030400], // 60*60*24*7*4*12*100, 60*60*24*7*4*12\n                [5806080000, 'Last century', 'Next century'], // 60*60*24*7*4*12*100*2\n                [58060800000, 'centuries', 2903040000] // 60*60*24*7*4*12*100*20, 60*60*24*7*4*12*100\n                ];\n                var seconds = (+new Date() - time) / 1000,\n                    token = 'ago',\n                    list_choice = 1;\n\n                if (seconds == 0) {\n                    return 'Just now';\n                }\n                if (seconds < 0) {\n                    seconds = Math.abs(seconds);\n                    token = 'from now';\n                    list_choice = 2;\n                }\n                var i = 0,\n                    format;\n                while (format = time_formats[i++]) {\n                    if (seconds < format[0]) {\n                        if (typeof format[2] == 'string') return format[list_choice];else return Math.floor(seconds / format[2]) + ' ' + format[1] + ' ' + token;\n                    }\n                }return time;\n            });\n\n            var news_source = $(\"#news-template\").html();\n            var news_template = Handlebars.compile(news_source);\n            var context_news = bloomberg.news;\n            $(\"#newsResults\").html(news_template(context_news));\n\n            //console.log(\"bloomberg: \"+ JSON.stringify(bloomberg.press_release));\n\n            var press_source = $(\"#press-template\").html();\n            var press_template = Handlebars.compile(press_source);\n            var context_press = bloomberg.press_release;\n            $(\"#pressResults\").html(press_template(context_press));\n\n            //console.log(secretsSummary);\n            secretsSummary = {\n                cycle: secretsSummary.cycle,\n                total: numberWithCommas(secretsSummary.total),\n                dems: numberWithCommas(secretsSummary.dems),\n                repubs: numberWithCommas(secretsSummary.repubs),\n                lobbying: numberWithCommas(secretsSummary.lobbying),\n                mems_invested: secretsSummary.mems_invested,\n                congress_percent: Number(Math.round(secretsSummary.mems_invested / 535 * 100 + 'e2') + 'e-2'),\n                orgname: secretsSummary.orgname,\n                source: \"http://\" + secretsSummary.source\n            };\n\n            var lobbying_source = $(\"#lobbying-template\").html();\n            var lobbying_template = Handlebars.compile(lobbying_source);\n            var context_lobbying = secretsSummary;\n            $(\"#lobbyingResults\").html(lobbying_template(context_lobbying));\n\n            //enter brand name in company facts title\n            $(\"#parentCo\").html(parentCo);\n        }, function (err) {\n            alert(err.responseText);\n        });\n    }\n\n};\n"]}